<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ניהול פתרונות למידה</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div id="loginBox">
    <h2>🔐 כניסת מנהל</h2>
    <label>שם משתמש:</label>
    <input type="text" id="adminUser" placeholder="Pisga">
    <label>סיסמה:</label>
    <input type="password" id="adminPass" placeholder="Sara@2203">
    <button onclick="verifyLogin()">התחבר</button>
    <p id="loginMsg"></p>
  </div>

  <div id="mainBox" style="display:none;">
    <h2>📂 ניהול פתרונות למידה</h2>
    <table id="solutionsTable">
      <thead>
        <tr>
          <th>מזהה</th>
          <th>שם</th>
          <th>מרצה</th>
          <th>שעות</th>
          <th>פעולות</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="addNew()">➕ הוסף חדש</button>
    <button onclick="saveData()">💾 שמור</button>
    <p id="status"></p>
  </div>

  <script>
    let data = [];

    function verifyLogin() {
      const user = document.getElementById("adminUser").value;
      const pass = document.getElementById("adminPass").value;
      if (user === "Pisga" && pass === "Sara@2203") {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("mainBox").style.display = "block";
        loadData();
      } else {
        document.getElementById("loginMsg").textContent = "שגיאה בפרטי ההתחברות.";
      }
    }

    function loadData() {
      fetch('solutions.json')
        .then(res => res.json())
        .then(json => {
          data = json;
          renderTable();
        });
    }

    function renderTable() {
      const tbody = document.querySelector("#solutionsTable tbody");
      tbody.innerHTML = "";
      data.forEach((item, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td><input value="${item.id}" onchange="data[${index}].id = this.value"></td>
          <td><input value="${item.title}" onchange="data[${index}].title = this.value"></td>
          <td><input value="${item.instructor}" onchange="data[${index}].instructor = this.value"></td>
          <td><input type="number" value="${item.hours}" onchange="data[${index}].hours = parseInt(this.value)"></td>
          <td><button onclick="removeRow(${index})">🗑️ מחק</button></td>
        `;
        tbody.appendChild(row);
      });
    }

    function addNew() {
      data.push({ id: "", title: "", instructor: "", hours: 0 });
      renderTable();
    }

    function removeRow(index) {
      data.splice(index, 1);
      renderTable();
    }

    function saveData() {
      const content = JSON.stringify(data, null, 2);
      const blob = new Blob([content], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = "solutions.json";
      link.click();
      document.getElementById("status").textContent = "הקובץ נשמר (הורדה ללקוח).";
    }
  </script>
</body>
</html>
